<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{pkg} v{ver} status</title>
  <link rel="icon" href="/favicon.ico" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/dseg14-classic/400.css" />
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <div class="card" id="card" style="position:relative; overflow:hidden;">
    <div class="logo-bg"><img id="logo" src="/logo.png?v=1" alt="trx logo" onerror="console.error('logo load failed'); this.style.display='none'" /></div>
    <div class="header" style="position:relative; z-index:2;">
      <div>
        <div class="title"><span id="rig-title">Rig status</span></div>
        <div class="subtitle" id="server-subtitle"></div>
        <div class="subtitle">{pkg} v{ver}</div>
      </div>
    </div>
    <div id="loading" style="text-align:center; padding:2rem 0;">
      <div id="loading-title" style="margin-bottom:0.4rem; font-size:1.1rem; font-weight:600;">Initializing (rig)…</div>
      <div id="loading-sub" style="color:#9aa4b5;"></div>
    </div>
    <div id="content" style="display:none;">
    <div class="status">
      <div class="full-row">
        <div class="label">Frequency<span class="band-tag" id="band-label">--</span></div>
        <div class="inline">
          <input class="status-input" id="freq" type="text" value="--" />
          <button id="freq-apply" type="button">Set</button>
        </div>
        <div class="jog-container">
          <button id="jog-down" type="button" class="jog-btn">&minus;</button>
          <div class="jog-wheel" id="jog-wheel">
            <div class="jog-indicator" id="jog-indicator"></div>
          </div>
          <button id="jog-up" type="button" class="jog-btn">+</button>
          <div class="jog-step" id="jog-step">
            <button type="button" data-step="1000000">MHz</button>
            <button type="button" data-step="1000" class="active">kHz</button>
            <button type="button" data-step="1">Hz</button>
          </div>
        </div>
      </div>
      <div class="controls-row full-row">
        <div>
          <div class="label">Mode</div>
          <div class="inline">
            <select class="status-input" id="mode">
              <option value="">--</option>
            </select>
            <button id="mode-apply" type="button">Set</button>
          </div>
        </div>
        <div>
          <div class="label">Transmit / Power</div>
          <div class="btn-grid">
            <button id="ptt-btn" type="button">Toggle PTT</button>
            <button id="power-btn" type="button">Toggle Power</button>
            <button id="lock-btn" type="button">Lock</button>
          </div>
        </div>
      </div>
      <div class="full-row" id="vfo-row">
        <div class="label">VFO</div>
        <div class="vfo-picker" id="vfo-picker"></div>
      </div>
      <div class="full-row">
        <div class="label">Signal</div>
        <div class="signal" style="gap: 1rem;">
          <div class="signal-bar"><div class="signal-bar-fill" id="signal-bar"></div></div>
          <div class="signal-value" id="signal-value">--</div>
        </div>
        <canvas id="signal-graph" width="600" height="60"></canvas>
      </div>
      <div class="full-row" id="tx-meters" style="display:none;">
        <div class="label">TX Meters</div>
        <div class="meter" style="gap: 1rem; margin-bottom: 0.4rem;">
          <div class="meter-bar"><div class="meter-fill" id="pwr-bar"></div></div>
          <div class="meter-value" id="pwr-value">PWR --</div>
        </div>
        <div class="meter" style="gap: 1rem;">
          <div class="meter-bar"><div class="meter-fill" id="swr-bar"></div></div>
          <div class="meter-value" id="swr-value">SWR --</div>
        </div>
      </div>
      <div id="tx-limit-row" style="display:none;">
        <div class="label">TX Limit — units depend on rig (percentage/watts)</div>
        <div class="inline">
          <input class="status-input" id="tx-limit" type="number" min="0" max="255" step="1" value="" placeholder="--" />
          <button id="tx-limit-btn" type="button">Set</button>
        </div>
      </div>
    </div>
    <div class="full-row" id="audio-row">
      <div class="label">Audio</div>
      <div class="inline" style="gap: 0.6rem; flex-wrap: wrap; align-items: center;">
        <button id="rx-audio-btn" type="button">RX Audio</button>
        <button id="tx-audio-btn" type="button">TX Audio</button>
        <label class="vol-label">RX<input type="range" id="rx-vol" min="0" max="100" value="80" class="vol-slider" /><small class="vol-pct" id="rx-vol-pct">80%</small></label>
        <label class="vol-label">TX<input type="range" id="tx-vol" min="0" max="100" value="80" class="vol-slider" /><small class="vol-pct" id="tx-vol-pct">80%</small></label>
        <div id="audio-level" style="flex: 1 1 auto; height: 12px; border-radius: 999px; background: #1f2937; border: 1px solid #2d3748; overflow: hidden; min-width: 80px;">
          <div id="audio-level-fill" style="height: 100%; width: 0%; background: linear-gradient(90deg, #00d17f, #f0ad4e); transition: width 100ms ease;"></div>
        </div>
        <small id="audio-status" style="min-width: 60px;">Off</small>
      </div>
    </div>
    <div class="footer">
      <div class="copyright">Built by Stan Grams SP2SJG from <a href="https://haxx.space" target="_blank" rel="noopener">haxx.space</a> — <span id="copyright-year"></span></div>
      <div class="hint" id="power-hint">Connecting…</div>
    </div>
    </div>
  </div>
  <script src="/app.js"></script>
</body>
</html>
